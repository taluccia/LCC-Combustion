---
title: "Organize Soil Grid data"
author: "Anna Talucci"
date: "2025-08-18"
output: html_document
---
```{r clear environment, include=FALSE}
rm(list=ls())
```

# Overview

Read in soil grid data extracted from google earth engine. Clean and edit names to match previous iterations of the combustion modeling data frame and export to use in updated combustion model data frame

# Packages

```{r}
library(tidyverse)
```

# Data
2025-08-18_staticSoilPfi_FISL
```{r}
fisl = read_csv("../data/2025-08-08_combustion_layer_update/2025-08-18_soil/2025-08-18_staticSoil30cm_FISL.csv")
lc = read_csv("../data/2025-08-08_combustion_layer_update/2025-08-18_soil/2025-08-18_staticSoil30cm_LC.csv")
org = read_csv("../data/2025-08-08_combustion_layer_update/2025-08-18_soil/2025-08-18_staticSoil30cm_ORG.csv")
lcc = read_csv("../data/2025-08-08_combustion_layer_update/2025-08-18_soil/2025-08-18_staticSoil30cm_LCC.csv")
```

```{r}
fisl_pfi = read_csv("../data/2025-08-08_combustion_layer_update/2025-08-18_soil/2025-08-18_staticSoilPfi_FISL.csv")
lc_pfi = read_csv("../data/2025-08-08_combustion_layer_update/2025-08-18_soil/2025-08-18_staticSoilPfi_LC.csv")
org_pfi = read_csv("../data/2025-08-08_combustion_layer_update/2025-08-18_soil/2025-08-18_staticSoilPfi_ORG.csv")
lcc_pfi = read_csv("../data/2025-08-08_combustion_layer_update/2025-08-18_soil/2025-08-18_staticSoilPfi_LCC.csv")
```

# View Data

```{r}
fisl
lc
org
lcc
```
```{r}
fisl_pfi
lc_pfi
org_pfi
lcc_pfi
```


```{r}
names(lcc)
names(lcc_pfi)
```

# Clean
Rename soil variables to match previous iterations and select variables of interest.

## Function
pH_30
Sand_30
Silt_30
Clay_30
BD_30
SOC_30
```{r}


clean_select_pfi <- function(df){df %>%
    select(ID, PFI) 
}

clean_select_soil <- function(df1, df2){df1 %>% 
    rename(BD_30 = bdod_0_30cm, Clay_30 = clay_0_30cm, pH_30 = phh2o_0_30cm, Sand_30 = sand_0_30cm, Silt_30 = silt_0_30cm, SOC_30 = soc_0_30cm) %>%
  select(ID, BD_30, pH_30, Sand_30, Silt_30, Clay_30, SOC_30) %>%
    left_join(df2, by ="ID")
}
```



```{r}
(fisl_pfi_sub = clean_select_pfi(fisl_pfi))
(lc_pfi_sub = clean_select_pfi(lc_pfi))
(lcc_pfi_sub = clean_select_pfi(lcc_pfi))
(org_pfi_sub = clean_select_pfi(org_pfi))
```


```{r}
(fisl_soil_sub = clean_select_soil(fisl, fisl_pfi_sub ))
(lc_soil_sub = clean_select_soil(lc, lc_pfi_sub))
(lcc_soil_sub = clean_select_soil(lcc, lcc_pfi_sub))
(org_soil_sub = clean_select_soil(org, org_pfi_sub))
```


# Save

## Write to CSV

```{r}
write_csv(lc_soil_sub, "../outputs/2025-08-18_cleaned/csv/2025-08-18_Soil_LC.csv")
write_csv(lcc_soil_sub, "../outputs/2025-08-18_cleaned/csv/2025-08-18_Soil_LCC.csv")
write_csv(fisl_soil_sub, "../outputs/2025-08-18_cleaned/csv/2025-08-18_Soil_FISL.csv")
write_csv(org_soil_sub, "../outputs/2025-08-18_cleaned/csv/2025-08-18_Soil_ORG.csv")
```